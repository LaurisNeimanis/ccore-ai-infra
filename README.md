# ccore-ai-infra

Infrastructure-as-Code templates for AWS using **Terraform** and **Ansible**.  
This repository demonstrates a clean, productionâ€‘grade DevOps workflow.

- AWS VPC + networking
- EC2 provisioning
- Secure bootstrap using cloud-init
- Automated configuration with Ansible
- Environment separation (dev / prod)
- CI examples for Terraform & Ansible

The goal is to showcase real DevOps engineering practices in a minimal, reproducible form.

---

## ðŸ“Œ Terraform State (Production Recommendation)

Production setups must use:

- **S3 bucket** for remote Terraform state
- **DynamoDB table** for stateâ€‘locking

For demo purposes this repo keeps state **local**, but switching to S3+DynamoDB requires only updating the backend block.

---

## 1. Architecture Overview

```
Terraform â†’ AWS infra â†’ cloudâ€‘init â†’ Ansible â†’ Docker â†’ Full app stack
```

Mermaid diagram:

```mermaid
flowchart TD
    A[Terraform Apply] --> B[VPC + Subnet + Route Table]
    A --> C[EC2 Instance]
    A --> D[Generate hosts.ini]

    C --> E[cloud-init bootstrap]
    E --> F[Ansible Playbook]

    F --> G[Docker Install Role]
    F --> H[Python Demo App Role]

    H --> I[Docker Compose Stack]
```

---

## 2. Folder Structure

```
ccore-ai-infra/
â”œâ”€â”€ terraform/
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”œâ”€â”€ network/
â”‚   â”‚   â””â”€â”€ compute/
â”‚   â”œâ”€â”€ envs/
â”‚   â”‚   â”œâ”€â”€ dev/
â”‚   â”‚   â””â”€â”€ prod/
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ ansible/
â”‚   â”œâ”€â”€ inventory/
â”‚   â”‚   â””â”€â”€ hosts.ini        # Autoâ€‘generated by Terraform
â”‚   â”œâ”€â”€ playbook.yml
â”‚   â”œâ”€â”€ roles/
â”‚   â”‚   â”œâ”€â”€ docker-install/
â”‚   â”‚   â””â”€â”€ python-demo-app/
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ diagrams/
â”‚   â””â”€â”€ architecture.mmd
â”‚
â””â”€â”€ README.md
```

Terraform provisions infra â†’ then generates:

```
ansible/inventory/hosts.ini
```

Example:

```
[app]
3.67.196.100 ansible_user=ubuntu
```

This keeps IPs out of Git and ensures alwaysâ€‘fresh inventory.

---

## 3. Usage

### Step 1 â€“ Configure AWS credentials

Either:

- AWS SSO
- or access keys
- or env variables  
  (`AWS_ACCESS_KEY_ID`, `AWS_SECRET_ACCESS_KEY`)

### Step 2 â€“ Initialize Terraform

```
cd terraform/envs/dev
terraform init
```

### Step 3 â€“ Apply infrastructure

```
terraform apply
```

### Step 4 â€“ Run Ansible provisioning

```
ansible-playbook -i ansible/inventory/hosts.ini ansible/playbook.yml
```

This installs:

- Docker Engine
- Docker Compose plugin
- Python demo app
- Nginx reverse proxy
- SSL (selfâ€‘signed)
- Complete Docker Compose stack under `/opt/app`

---

## 4. Technologies Used

- Terraform
- Ansible
- Docker & Docker Compose
- AWS EC2 / VPC / IAM
- cloudâ€‘init
- GitHub Actions CI

---

## 5. Purpose

Designed to:

- Demonstrate real DevOps workflows
- Provide reusable AWS IaC templates
- Serve as a training/portfolio project
- Maintain clarity + minimalism

---

## 6. License

MIT License.
